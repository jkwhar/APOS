{% extends "base.html" %}
{% block title %}Project Used History{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Project Used History — {{ part.part_number }}</h2>
    <a href="{{ url_for('parts_list') }}" class="btn btn-secondary btn-sm">← Back to Parts List</a>
</div>

{% if logs %}
<div class="table-responsive">
    <table class="table table-striped table-bordered align-middle shadow-sm">
        <thead class="table-primary">
            <tr>
                <th style="width: 60px;">#</th>
                <th>Action</th>
                <th>Qty Δ</th>
                <th>Detail</th>
                <th>Recorded</th>
                <th style="width: 120px;">Delete</th>
            </tr>
        </thead>
        <tbody>
            {% for log in logs %}
            <tr>
                <td class="fw-bold">{{ loop.index }}</td>
                <td>{{ log.action }}</td>
                <td>
                    {% if log.quantity_delta is not none %}
                        {{ log.quantity_delta }}
                    {% else %}
                        —
                    {% endif %}
                </td>
                <td>{{ log.detail or "-" }}</td>
                <td>{{ log.created_at.strftime("%m/%d/%Y %I:%M %p") }}</td>
                <td>
                    <form action="/part/{{ part.id }}/history/delete" method="post"
                          onsubmit="return confirm('Delete this entry?');">
                        <input type="hidden" name="log_id" value="{{ log.id }}">
                        <button type="submit" class="btn btn-danger btn-sm w-100">
                            Delete
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="alert alert-info shadow-sm">
    No project usage history has been recorded for this part.
</div>
{% endif %}

{% endblock %}
